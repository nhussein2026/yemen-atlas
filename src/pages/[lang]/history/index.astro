---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import ContentPageHeader from "../../../components/ContentPageHeader.astro";
import ContentCard from "../../../components/ContentCard.astro";
import { getCollection } from "astro:content";
import { assertLang } from "../../../lib/lang";

// Static paths for English and Arabic
export async function getStaticPaths() {
  return [{ params: { lang: "en" } }, { params: { lang: "ar" } }];
}

const { lang } = Astro.params;
assertLang(lang);

// Get all history entries
const historyEntries = await getCollection("history");

const pageTitle = lang === "en" ? "History" : "التاريخ";
const pageDescription =
  lang === "en"
    ? "Explore Yemen's rich historical heritage, ancient kingdoms, and cultural landmarks."
    : "استكشف التراث التاريخي الغني لليمن والممالك القديمة والمعالم الثقافية.";
---

<BaseLayout lang={lang} title={pageTitle}>
  <ContentPageHeader
    title={pageTitle}
    description={pageDescription}
    lang={lang}
  />

  <div
    class={`${lang === "ar" ? "rtl" : "ltr"}`}
    dir={lang === "ar" ? "rtl" : "ltr"}
  >
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {
        historyEntries.map((entry) => (
          <ContentCard
            title={entry.data.title[lang]}
            excerpt={entry.data.summary[lang]}
            href={`/${lang}/history/${entry.slug}`}
            date={entry.data.period?.[lang]}
            category={lang === "en" ? "History" : "التاريخ"}
            lang={lang}
          />
        ))
      }
    </div>

    {
      historyEntries.length === 0 && (
        <p class="text-center py-12" style="color: var(--color-text-dark);">
          {lang === "en"
            ? "No historical entries yet."
            : "لا توجد إدخالات تاريخية حتى الآن."}
        </p>
      )
    }
  </div>
</BaseLayout>
